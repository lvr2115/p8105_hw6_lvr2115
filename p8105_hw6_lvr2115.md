Homework 6 - lvr2115
================
Laura Robles-Torres
2023-11-30

``` r
library(modelr)
library(tidyverse)
library(mgcv)
library(p8105.datasets)

set.seed(1)
```

# Problem 2

``` r
weather_df = 
  rnoaa::meteo_pull_monitors(
    c("USW00094728"),
    var = c("PRCP", "TMIN", "TMAX"), 
    date_min = "2022-01-01",
    date_max = "2022-12-31") |>
  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY"),
    tmin = tmin / 10,
    tmax = tmax / 10) |>
  select(name, id, everything())
```

This code creates a multiple linear regression model with ‘tmax’ as the
response with ‘tmin’ and ‘prcp’ as the predictors.

``` r
fit = lm(tmax ~ tmin + prcp, data = weather_df)

fit |> 
  broom::glance()
```

    ## # A tibble: 1 × 12
    ##   r.squared adj.r.squared sigma statistic   p.value    df logLik   AIC   BIC
    ##       <dbl>         <dbl> <dbl>     <dbl>     <dbl> <dbl>  <dbl> <dbl> <dbl>
    ## 1     0.916         0.915  2.96     1972. 2.19e-195     2  -912. 1832. 1848.
    ## # ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>

``` r
fit |>
  broom::tidy()
```

    ## # A tibble: 3 × 5
    ##   term        estimate std.error statistic   p.value
    ##   <chr>          <dbl>     <dbl>     <dbl>     <dbl>
    ## 1 (Intercept)  8.04      0.230      35.0   4.39e-118
    ## 2 tmin         1.01      0.0162     62.7   1.43e-196
    ## 3 prcp        -0.00154   0.00210    -0.733 4.64e-  1

Use 5000 bootstrap samples and, for each bootstrap sample, produce
estimates of these two quantities. Plot the distribution of your
estimates, and describe these in words. Using the 5000 bootstrap
estimates, identify the 2.5% and 97.5% quantiles to provide a 95%
confidence interval for r^2 and log(β1∗β 2).

``` r
weather_df_samples =
  weather_df |> 
  modelr::bootstrap(n = 500, id="strap_number") |> 
  mutate(
    models = map(.x=strap, ~lm(tmax ~ tmin + prcp, data = .x)),
    results = map(.x=models, broom::tidy)) |> 
  select(strap_number, results) |>
  unnest(results) |> 
  ggplot(aes(x = r.squared)) + geom_density()
```

Note: broom::glance() i- r^2 from a fitted regression, broom::tidy()
(with some additional wrangling) should help in computing log(β̂ 1∗β̂ 2)

``` r
fit |> 
  broom::glance() |> 
  select(r.squared) |> 
  knitr::kable(digits = 3)
```

| r.squared |
|----------:|
|     0.916 |

``` r
beta1 = coef(fit)[2]
beta2 = coef(fit)[3]

fit |>
  broom::tidy()|>
  select(term, estimate) |>
  mutate(
    log_product = log(beta1*beta2)
  )
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `log_product = log(beta1 * beta2)`.
    ## Caused by warning in `log()`:
    ## ! NaNs produced

    ## # A tibble: 3 × 3
    ##   term        estimate log_product
    ##   <chr>          <dbl>       <dbl>
    ## 1 (Intercept)  8.04            NaN
    ## 2 tmin         1.01            NaN
    ## 3 prcp        -0.00154         NaN
